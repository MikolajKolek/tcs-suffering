\subsection{Weryfikacja równości wielomianów}
Mamy stworzyć algorytm sprawdzajacy równość wielomianów \(F\) i \(G\). Przykładowo \\
\[
	(x+1)(x-2)(x+3)(x-4)(x+5)(x-6) \overset{?}{\equiv} x^6 - 7x^3 + 25
\]

Dla stopnia wielomianu \(d\), złożoność to \(O(d^2)\) (wymnażamy wszystko i sprawdzamy współczynniki). Chcemy sprawdzić poprawność algorytmu w lepszym czasie.

Nasz algorytm:
\begin{itemize}
    \item Wybierz \(r\) losowo (każdy z równym prawdopodobieństwem - \textit{rozkład jednostajny} / \textit{uniform distribution}) ze zbioru \(\{1,...,100d\}\)
	\item Oblicz \(F(r)\) i \(G(r)\)
    \item Jeśli \(F(r) \neq G(r)\), to zwróć \texttt{false}
    \item Jeśli \(F(r) = G(r)\), to zwróć \texttt{true}
\end{itemize}

Jeżeli algorytm zwróci \texttt{false}, to na pewno \(F\) i \(G\) są różne. Jeżeli zwróci \texttt{true}, to pomyli się tylko wtedy, gdy \(r\) jest pierwiastkiem \(F(x) - G(x)\), a tych jest co najwyżej d. Możemy się więc spodziewać, że prawdopodobieństwo, że algorytm się pomyli jest równe
\[
	p = \frac{d}{100d} = \frac{1}{100}
\]

\begin{proof}
	\(\Omega = \{1,...,100d\}\), \(E\) - zdarzenie takie, że algorytm się pomylił
	\begin{align*}
		\prob(E) &= \prob(\textit{Algorytm wylosował pierwiastek $F(x) - G(x) \in \{1, ..., 100d\}$}) \\
		&\leq \frac{\#\text{pierwiastków } F(x) - G(x)}{100d} \\
		&\leq \frac{d}{100d} = \frac{1}{100}
	\end{align*}
\end{proof}

\noindent Jeżeli puścimy ten algorytm kilka razy: \\
\(E_i\) - zdarzenie, że algorytm się pomyli za i-tym razem (te zdarzenia są niezależne) \\
\[
	\prob(E_1 \cap ... \cap E_k) = \prod_{i \in [k]}\prob(E_i) \leq (\frac{1}{100})^k
\]


\subsection{Weryfikacja wyniku mnożenia macierzy}
Mamy trzy macierze \(A, B, C\) o rozmiarze \(n \times n\) nad zbiorem \(\{0,1\}\) (arytmetyka mod 2). Chcemy napisać algorytm sprawdzający
\[
	AB \overset{?}{=} C
\]
Normalne mnożenie działa w \(O(n^3)\) 

Nasz algorytm:
\begin{itemize}
    \item \(\overline{r} = (r_1, ..., r_n) \in \{0,1\}^n\), wybrane losowo jednostajnie
    \item oblicz \(A(B\overline{r})\) i \(C\overline{r}\) (w \(O(n^2)\))
    \item jeżeli wyniki są różne, to zwróć \texttt{false}
    \item jeżeli są równe, to zwróć \texttt{true}
\end{itemize}

Jeżeli \(AB \neq C\) i \(\overline{r}\) jest wybrane losowo i jednostajnie, to 
\[
	\prob(A(B\overline{r}) = C\overline{r}) \leq \frac{1}{2}
\]

\begin{proof}
	Niech \(D = AB-C \neq 0\). Zakładamy bez straty ogólności \(d_{1,1} \neq 0\)
	\[
		D\overline{r} = 0 \implies \sum_{j=1}^n d_{1,j} r_j = 0 \implies r_1 = \frac{-\sum_{j=2}^n d_{1,j} r_j}{d_{1,1}}
	\]
	Widzimy, że \(r_1\) musi mieć ustaloną wartość w oparciu na \(r_2, \dots\), a więc w przynajmniej połowie przypadków \(r_1\) nie ma odpowiedniej wartości i \(A(B\overline{r}) \neq C\overline{r}\).
\end{proof}
